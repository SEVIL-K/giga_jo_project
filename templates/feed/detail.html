{% extends 'base.html' %}
{% block title %}피드 상세 페이지{% endblock %}
{% block content %}
<div style="height: 640px;">
    <div class="form-container" style="height: auto; margin: 50px auto 0px auto;" 
        method="POST" action="/feed/read/{{feed.id}}/" enctype="multipart/form-data">

        <div class="form" method="POST" action="/feed/read/{{feed.id}}/" enctype="multipart/form-data">
            <span class="heading" style="color: rgb(0, 0, 0); font-weight: 500;">제목</span>
            <p class="input__field input__field--textarea" style="height: 10px;" id="title" name="title">
                {{feed.title}}</p>
        </div>
        <div class="form" method="POST" action="/feed/read/{{feed.id}}/" enctype="multipart/form-data">
            <span class="heading" style="color: rgb(0, 0, 0); font-weight: 500;">내용</span>
            <p class="input__field input__field--textarea" style="height: 10px;" id="content" name="content">
                {{feed.content}}</p>
        </div>
        <div class="form" method="POST" action="/feed/read/{{feed.id}}/" enctype="multipart/form-data">
            <span class="heading" style="color: rgb(0, 0, 0); font-weight: 500; ">생성 시간</span>
            <p class="input__field input__field--textarea" style="height: 10px;" id="created_at" name="created_at">
                {{feed.created_at}}</p>
                <span class="heading" style="color: rgb(0, 0, 0); font-weight: 500;">수정 시간</span>
            <p class="input__field input__field--textarea" style="height: 10px;" id="created_at" name="created_at">
                {{feed.updated_at}}</p>
        </div>
        <div style="padding-bottom: 10px; " align="right">
            {% if user.is_authenticated and user == feed.author %}
            <a href="/feed/update/{{feed.id}}/" class="btn btn-primary mt-3">수정하기</a>
            <form action="/feed/delete/{{feed.id}}/" method="post" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary mt-3">삭제하기</button>
            </form>
            {% endif %}
            <a href="/feedlist/" class="btn btn-primary mt-3">뒤돌아가기</a>
        </div>
        
        <form method="post" action="{% url 'create_comment' feed.id %}" class="mb-4">
            <span class="heading" style="color: rgb(0, 0, 0); font-weight: 500;">댓글</span>
            {% csrf_token %}
            <textarea class="form-control" name="content" rows="3" placeholder="여기에 댓글 작성해주세요"></textarea>
            
            <button type="submit" class="btn btn-primary mt-3" >댓글 작성</button>
        </form>
        
        <div class="card bg-light">
            
            <div class="card-body">
                
                <!-- Comment form -->
                <!-- Comment with nested comments -->
                <div class="comment-list">
                    {% for comment in comments %}
                    <div class="mb-4 comment-box" id="comment-{{ comment.pk }}" >
                        <div class="media" style="border: 1px solid #ccc; display:flex;" >
                            <div style="border-right: 1px solid #ccc;">
                                <img class="d-flex mr-3 rounded-circle" src="http://placehold.it/50x50" alt="">
                            </div>
                            <div class="media-body "style="border-right: 1px solid #ccc; flex-grow: 1;">
                                <!-- 작성자 이름과 날짜 -->
                                <h5 class="mt-0">{{ comment.author.username }}님 &nbsp;&nbsp;<small class="text-muted">{{ comment.created_at }}</small></h5>
                                <!-- 댓글 내용 -->
                                <p>{{ comment.content | linebreaks }}</p>
                            </div>
                                <!-- 댓글 수정 버튼: 로그인한 사용자와 댓글 작성자가 일치할 때만 보이게 -->
                                {% if user.is_authenticated and comment.author == user %}
                                <div class="float-right">
                                    <a role="button"
                                        class="btn btn-sm btn-info btn-update"
                                        id="comment-{{ comment.pk }}-update-btn"
                                        href="/feed/update_comment/{{ comment.pk }}/">
                                        수정
                                    </a>
                                    <div style="margin-top: 20px;">
                                    <a role="button"
                                        class="btn btn-sm btn-info btn-delete"
                                        id="comment-{{ comment.pk }}-delete-btn"
                                        href="/feed/delete_comment/{{ comment.pk }}/">
                                        삭제
                                    </a>
                                </div>
                                </div>
                                {% endif %}
                            
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        
    </div> 
        











    {% endblock %}